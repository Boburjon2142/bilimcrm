{% extends "base.html" %}
{% load humanize %}
{% block content %}
<div class="grid gap-6 lg:grid-cols-2">
  <div class="overflow-hidden rounded-xl border border-slate-100 bg-slate-50">
    {% if book.cover_image %}
    <img src="{{ book.cover_image.url }}" alt="{{ book.title }}" width="640" height="960" class="aspect-[2/3] w-full object-cover">
    {% else %}
    <img src="https://via.placeholder.com/640x960?text=Rasm+yo%27q" alt="{{ book.title }}" width="640" height="960" class="aspect-[2/3] w-full object-cover">
    {% endif %}
  </div>

  <div class="flex flex-col gap-4">
    <div>
      <h1 class="text-2xl font-semibold text-slate-900">{{ book.title }}</h1>
      <p class="mt-1 text-sm text-slate-500">{{ book.author.name }}</p>
    </div>
    <div class="flex flex-wrap gap-3 text-xs text-slate-500">
      {% if book.book_format %}<span>Format: {{ book.get_book_format_display }}</span>{% endif %}
      {% if book.pages %}<span>Sahifa: {{ book.pages }}</span>{% endif %}
    </div>
    <div class="text-2xl font-bold text-blue-600">{{ book.sale_price|floatformat:0|intcomma }} so'm</div>
    {% if book.description %}
    <p class="text-sm leading-6 text-slate-600">{{ book.description }}</p>
    {% endif %}

    <form method="post" action="{% url 'add_to_cart' book.id %}" class="flex flex-wrap items-center gap-3">
      {% csrf_token %}
      <input type="number" name="quantity" value="1" min="1" class="w-24 rounded-md border border-slate-200 px-3 py-2 text-center text-sm">
      <button class="rounded-full bg-blue-600 px-6 py-2 text-sm font-semibold text-white hover:bg-blue-700" type="submit">Savatga qo'shish</button>
    </form>

    <form method="post" action="{% if in_favorites %}{% url 'remove_favorite' book.id %}{% else %}{% url 'add_favorite' book.id %}{% endif %}">
      {% csrf_token %}
      <button class="rounded-full border border-slate-200 px-5 py-2 text-xs font-semibold text-slate-600 hover:border-blue-200 hover:text-blue-600" type="submit">
        {% if in_favorites %}Sevimlidan olib tashlash{% else %}Sevimlilarga qo'shish{% endif %}
      </button>
    </form>
  </div>
</div>
{% endblock %}
