{% extends "base.html" %}
{% load humanize %}
{% block content %}
<div class="flex flex-wrap items-end justify-between gap-3">
  <div>
    <h1 class="text-xl font-semibold text-slate-900">{{ category.name }}</h1>
    <p class="text-sm text-slate-500">Ushbu kategoriyadagi kitoblar</p>
  </div>
  <a href="{% url 'categories_list' %}" class="text-sm font-semibold text-blue-600">Barcha kategoriyalar</a>
</div>

{% if child_categories %}
<div class="mt-4 flex flex-wrap gap-2">
  {% for child in child_categories %}
  <a href="{% url 'category_detail' child.slug %}" class="rounded-full border border-slate-200 px-3 py-1 text-xs font-semibold text-slate-600 hover:border-blue-200 hover:text-blue-600">
    {{ child.name }}
  </a>
  {% endfor %}
</div>
{% endif %}

<form method="get" class="mt-6 grid gap-3 rounded-lg border border-slate-100 bg-white p-4 sm:grid-cols-2">
  <div>
    <label class="text-xs font-semibold text-slate-500">Muallif</label>
    <select name="author" class="mt-2 w-full rounded-md border border-slate-200 px-3 py-2 text-sm">
      <option value="">Barchasi</option>
      {% for author in authors %}
      <option value="{{ author.id }}" {% if author.id|stringformat:'s' == current_author %}selected{% endif %}>{{ author.name }}</option>
      {% endfor %}
    </select>
  </div>
  <div>
    <label class="text-xs font-semibold text-slate-500">Saralash</label>
    <select name="sort" class="mt-2 w-full rounded-md border border-slate-200 px-3 py-2 text-sm">
      <option value="">Standart</option>
      <option value="price_asc" {% if current_sort == "price_asc" %}selected{% endif %}>Narx: arzon - qimmat</option>
      <option value="price_desc" {% if current_sort == "price_desc" %}selected{% endif %}>Narx: qimmat - arzon</option>
      <option value="newest" {% if current_sort == "newest" %}selected{% endif %}>Eng yangi</option>
      <option value="oldest" {% if current_sort == "oldest" %}selected{% endif %}>Eng eski</option>
      <option value="popular" {% if current_sort == "popular" %}selected{% endif %}>Ko'p ko'rilgan</option>
    </select>
  </div>
  <div class="sm:col-span-2">
    <button class="rounded-full bg-blue-600 px-5 py-2 text-sm font-semibold text-white hover:bg-blue-700" type="submit">Filtrni qo'llash</button>
  </div>
</form>

<div class="mt-6 grid grid-cols-2 gap-4 sm:grid-cols-3 lg:grid-cols-4">
  {% for book in books %}
    {% include "partials/product_card.html" with book=book %}
  {% empty %}
  <p class="text-sm text-slate-500">Bu kategoriyada kitoblar topilmadi.</p>
  {% endfor %}
</div>
{% endblock %}
