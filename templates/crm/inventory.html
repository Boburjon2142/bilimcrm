{% extends "crm/base.html" %}
{% load humanize %}

{% block title %}Ombor{% endblock %}

{% block content %}
<div class="d-flex flex-wrap justify-content-between align-items-center mb-3 gap-2">
  <h4 class="mb-0">Ombor nazorati</h4>
  <span class="crm-pill">Kitoblar: {{ books|length|intcomma }}</span>
</div>

<div class="card crm-card p-3 mb-4">
  <form method="post" class="row g-2 align-items-end">
    {% csrf_token %}
    <div class="col-md-5">
      <label class="form-label">Kitob</label>
      <select name="book_id" class="form-select">
        {% for book in books %}
        <option value="{{ book.id }}">{{ book.title }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="col-md-2">
      <label class="form-label">O'zgarish</label>
      <input type="number" name="delta" class="form-control" placeholder="Masalan: -2">
    </div>
    <div class="col-md-3">
      <label class="form-label">Izoh</label>
      <input type="text" name="note" class="form-control" placeholder="Tuzatish sababi">
    </div>
    <div class="col-md-2">
      <button class="btn btn-primary w-100" type="submit">Saqlash</button>
    </div>
  </form>
</div>

<div class="card crm-card p-3">
  <table class="table crm-table align-middle">
    <thead>
      <tr>
        <th>Kitob</th>
        <th>Shtrix-kod</th>
        <th class="text-end">Ombor</th>
      </tr>
    </thead>
    <tbody>
      {% for book in books %}
      <tr>
        <td>{{ book.title }}</td>
        <td>{{ book.barcode|default:"â€”" }}</td>
        <td class="text-end">{{ book.stock_quantity|intcomma }}</td>
      </tr>
      {% empty %}
      <tr><td colspan="3" class="text-muted">Kitoblar yo'q</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
